#!/bin/bash
#SBATCH -A do022
#SBATCH -p ciuk-dine
#SBATCH -N 1
#SBATCH -n 1
#SBATCH -t 00:30:00
#SBATCH --exclusive
#SBATCH -o /cosma/home/do022/dc-kyaw1/ciuk2025/results/likwid_dine_%j.out
#SBATCH -e /cosma/home/do022/dc-kyaw1/ciuk2025/results/likwid_dine_%j.err

export PATH=/cosma/apps/do022/dc-kyaw1/likwid/bin:$PATH

cd /cosma/home/do022/dc-kyaw1/ciuk2025/results/

echo "=== LIKWID Benchmark on DINE ===" > likwid_summary_dine.txt
likwid-topology >> likwid_summary_dine.txt

echo "Running memory-bandwidth tests..." >> likwid_summary_dine.txt
likwid-bench -t copy  -W S0:1GB -i 5 >> likwid_summary_dine.txt
likwid-bench -t triad -W S0:1GB -i 5 >> likwid_summary_dine.txt

echo "Running compute test..." >> likwid_summary_dine.txt
likwid-bench -t peakflops_avx -W S0:1GB -i 5 >> likwid_summary_dine.txt

echo "âœ… LIKWID benchmark on DINE complete"
